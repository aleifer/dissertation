%!TEX root = /Users/andy/Documents/Academics/Dissertation/thesis.tex
\begin{savequote}[75mm] 
To cross the threshold from where we are to where we want to be, major conceptual shifts must take place in how we study the brain. One such shift will be from studying elementary processes---single proteins, single genes, and single cells---to studying systems properties---mechanisms made up of many proteins, complex systems of nerve cells, the functioning of whole organisms, and the interaction of groups of organisms. Cellular and molecular approaches will certainly continue to yield important information in the future, but they cannot by themselves unravel the secrets of internal representations of neural circuits or the interaction of circuits---the key steps linking cellular and molecular neuroscience to cognitive neuroscience. 
\qauthor{Eric R. Kandel, \citep{kandel_search_2007}} 
\end{savequote}

\chapter{Introduction}\label{chapter:intro}

\lettrine{H}{ow do a collection of neurons} work together to receive information from the environment, encode that information, and then process it to generate  purposeful behavior?  This is the fundamental question  confronting researchers in the field of systems neuroscience, and is the singular focus of many laboratories around the world. While much progress is being made to answer this question, our understanding has been limited in part by the lack of tools to simultaneously probe and observe the activity of individual neurons and their effect on whole-organism behavior. In particular, there is a distinct need for non-invasive techniques to stimulate and record from ensembles of neurons across an organism with single-cell resolution in awake, intact, unrestrained animals whose behavior can be observed simultaneously.

This need has motivated my thesis work and prompted me to develop new tools and techniques combining optogenetics, microscopy, and computer vision, to optically monitor and manipulate neural activity in freely behaving \emph{Caenorhabditis elegans}. Using the tools presented in this work, I provide new insights into how a network of neurons drives locomotion. That work is covered in Chapters \ref{chapter:colbert}, \ref{chapter:proprioceptive} and  \ref{chapter:omegaTurn}. Along the way, I employed similar techniques  toward the development of  novel fluorescent reporter constructs for next-generation microarray and lab-on-a-chip technologies. That work is discussed in Chapters \ref{chapter:DNAbarcode} and \ref{chapter:DNAtheory}. The neuronal basis of behavior, however, remains the primary focus of the thesis and of this introduction.


\section{Background}
The neuron is the fundamental unit of the brain.  Neurons are responsible for encoding information from an organism's environment and performing computations to transform that information into  behavior.  How this chain of events takes place has been studied with different approaches at different length scales, depending on the tools available at the time \citep{finger_origins_2001, kandel_essentials_1995}.

At the end of the 19th century, the development of the Golgi stain enabled Ram\'on y Cajal to approach this question by studying neuron morphology.  Cajal examined how individual neurons connected to one another, providing the first insights into the structure and function of neural circuits. Around the same time, the study of macroscopic  lesions in the brain provided another class of insights. Researchers like Pierre Paul Broca and Carl Wernicke were able to correlate lesions in human brains with defects in cognition, and thus were able to posit macroscopic models for how different brain regions interact with the nervous system. Single neuron function was again the focus of study as a new tool--electricity--was harnessed.  Luigi Galvani and Alassendro Volta in the 18th century, Hermann von Helmholtz and David Ferrier in the 19th century, and Charles Sherrington in the early 20th, used electrodes to probe the electrical activity of individual neurons. Once  op-amps were developed from radar work during  World War II, it became possible to clamp an individual neuron at a precise voltage or current. Alan Hodgkins, Andrew Huxley, Bernard KatzÂ and others used voltage clamps to rigorously characterize signaling within a single neuron. In a combination of microscopic and macroscopic investigation, the recent development of laser killing and genetic engineering have allowed researchers to systematically kill and ablate neurons or classes of neurons from a neural circuit while observing the resulting behavioral defects. 

None of these techniques however, have enabled researchers to non-invasively perform cell-specific intracellular manipulations  across an entire organism while simultaneously observing unrestrained behavior.  Such an approach is ideal to address the systems neuroscience goal of understanding how neurons across an entire  organism  transform an environmental input to motor output.  Recently, a confluence of advances has made such an investigion possible. The first is the advent of \textit{C. elegans} as a powerful model organism.

%THings I haven't mentioned: 
% --fMRI averages the activity of tens of thousands of neuorns together in a single voxel. Not unrestrained
% --mult-electrode array... heavily invasive
% --Electron microscopy... effectively the same as a golgi stain


%Broca, Ferrier, WErnicke

%Limited by information available
%This question has been appraoched at different times and different length scales depending on the tools available. Each of which operated at a differnet length scale and illuminated a small piece of the entire system. 
% Volta, Helmoltz and Sherrington -> 
%Golgi and Cajal 
%Hodgkins & Huxley & Katz -> op amp-> 
%Brain lesions, aphasia...
%Molecular geneticists in the latter half of the 20th century, this was studied by genetically inducing defects in classes of neurons and studying the results
%
%Hint at Optical physiology... non invasive... simultaneously operate at different length scales.. operate inside the cell and inside the organism... perform intracellular manipulation and observe the organism simultaneously
%Genetics







\subsection{\textit{C. elegans} as a model organism}
Invertabrate model organisms have yielded many universal principles of neuroscience.  Our understanding of the molecular basis of learning and memory, for example, came initially from studies of \textit{Aplysia}, a giant sea slug.  Similarly, our understanding of motor circuits was informed by early studies of leech and lamprey. 

The nematode \textit{Caenorhabditis elegans} has emerged as a popular and robust model organism and natural tool to study systems neuroscience. With only 302 neurons, its nervous system is compact but tractable. The 1 mm-long nematode exhibits a rich array of behaviors \citep{croll_components_1975}. It senses its environment,  navigates toward food \cite{grewal_migration_1992}  and temperatures \cite{ryu_thermotaxis_2002} that it prefers,  avoids chemicals that it dislikes \citep{croll_behavoural_1975}, and responds to touch \citep{chalfie_neural_1985}. The worm even exhibits associative learning--it can associate odors with foods that make it sick, and avoid them accordingly, for example\citep{zhang_pathogenic_2005}. 

Starting in the 1970's, White et al.~\citep{white_structure_1976, white_structure_1986}  mapped the entire wiring diagram of the \textit{C. elegans} nervous system. The individual neurons are morphologically identifiable and their connectivity is stereotyped from one worm to the next. The  scientific community has therefore been able to systematically study individual neurons and use tools such as laser ablation and transgenics to identify which neurons are part of which neural circuits. 

Critically, \textit{C. elegans} is also a major platform for molecular genetics and genetic engineering. It was the first organism into which the fluorescent reporter gene GFP was cloned \citep{chalfie_green_1994},  and it was the first multicellular eukaryote to have its genome sequenced \citep{sulston_c._1992,_genome_1998}. The nematode is especially convenient for genetic engineering. The worms have a fast generation time (a worm grows from egg to egg-laying adult at room temperature in about four days).  They are also naturally hermaphroditic and can self reproduce,  making it trivial to maintain isogenic lines. New genes can be added to the worm by injecting plasmids which are incorporated into an extrachromosomal array. The worms are then irradiated, and their DNA damage repair pathway incorporates the plasmids into their chromosomes to form stable transgenic lines.  In the hands of a skilled geneticist, the whole process--including outcrossing--takes less than a month. 

Importantly, \textit{C. elegans} is also optically transparent, and thus particularly amenable to advances in optical physiology and microscopy,  the primary tools used in this work. 

These attributes have made  \textit{C. elegans}  extremely well studied.  As a result, there is a rich repository of knowledge and resources available to the \textit{C. elegans} research community. Among the resources used commonly in the course of this work are:  WormBase, an online database of genes, phenotypes and publications \citep{harris_wormbase:_2010}; WormAtlas, a comprehensive online anatomical resource providing details of every neuron and cell \citep{altun_wormatlas_2002}; WormBook, a curated collection of review articles and methods \citep{the_c._elegans_research_community_wormbook_2011}; WormWeb, an online interactive network of neural connectivity \citep{bhatla_c._2009};  and the \textit{Caenorhabditis} Genetics Center at the University of Minnesota, which acts as a central repository and distributor for transgenic \textit{C. elegans} lines.


%There is a long history of using model organisms including invertebrates for neuroscience discovery. In the past \textit{Aplysia} has been used to study learning \citep{castellucci_neuronal_1970}, leech and lamprey for locomotion \citep{briggman_imaging_2006} and \textit{Drosophila} \citep{zhang_drosophila_2010} for a variety of nervous system functions. 
\textit{C. elegans}, with its compact nervous system, genetic tractability,  optical access and well-mapped neural circuitry, is an ideal candidate for studying the neural dynamics underlying behavior.

\subsection{Optical physiology}
Traditional electrophysiology is challenging to perform in the nematode \textit{C. elegans} \citep{goodman_active_1998, schafer_neurophysiological_2006}. The worm's small size and pressurized fluid-filled body make it difficult for electrodes to gain access to neurons.  As a result, electrophysiology experiments are  performed on worms that are partially dissected and immobilized. These preparations make it extremely difficult to correlate neural activity with behavior.  Advances in optogenetics and fluorescent reporters, however,  offer a viable alternative to electrophysiology. When used with transparent organisms, optical techniques are entirely non-invasive, making them the optimal choice for this work. 

\subsubsection{Optogenetics}
Optogenetics is an emerging field that refers to optical tools based on genetically encoded proteins that manipulate neural function. Karl Deisseroth and Ed Boyden founded the field of optogenetics with their joint development of Channelrhodopsin as an optical method for neural stimulation in  2005 \citep{boyden_millisecond-timescale_2005} and their simultaneous but independent development of Halorhodopsin as a method of neural silencing in 2007 \citep{zhang_multimodal_2007, han_multiple-color_2007}.  For a riveting historical account, see \citep{boyden_history_2011}. Optogenetic proteins like Channelrhodopsin and Halorhodopsin are light-activated transmembrane ion channels that open in response to light stimuli at a particular wavelength \citep{nagel_channelrhodopsin-2_2003, yizhar_optogenetics_2011, fenno_development_2011}. These optogenetic proteins were immediately employed  in \textit{C. elegans}, and an early experiment showed how illuminating worms expressing Channelrhodopsin in their mechanosensory neurons evoked a touch-like response  \citep{nagel_light_2005}.  The field has seen explosive growth in the past five years. For a review of optogenetics in \textit{C. elegans}, including some of the work presented here, see \citep{xu_early_2011} and \citep{yizhar_optogenetics_2011}. This work uses optogenetics as a tool to probe neural activity in a freely moving worm. 

\subsubsection{Fluorescent Reporters of Neural Activity}
Just as optogenetic proteins allow optical stimulation or inhibition of neural activity,  genetically encoded fluorescent reporters provide optical readouts of neural activity.  The first class of genetically encoded reporters were calcium indicators that altered their fluorescent properties in response to intracellular calcium levels. Calcium in a neuron is often used as a proxy for its membrane potential, and thus calcium indicators serve as an indirect measure of neural activity.   The first genetically encoded calcium indicator was cameleon \citep{miyawaki_fluorescent_1997}, a calmodulin protein modified by the addition of a Forster Resonance Energy Transfer (FRET) pair of fluorophores. As intracellular calcium levels increase, the calmodulin component of  cameleon contracts and pulls the two attached fluorescing proteins closer together, changing their fluorescence properties. The past decade has seen  steady improvement in genetically encoded calcium indicators that are brighter, more sensitive, and have greater dynamic range and faster response times \citep{miyawaki_innovations_2005,mank_genetically_2008,yamada_quantitative_2011}. In this work, I use one of the most recent indicators, GCaMP3 \citep{tian_imaging_2009}.
 
%Of course, it would be ideal to observe the membrane potential directly instead of merely observing calcium levels and the development of true genetically encoded voltage indicators for \textit{C. elegans} is just around the corner \citep{kralj_electrical_2011}. 

Both optogenetics and calcium indicators are non-invasive for transparent animals. This, in principal, allows \textit{C. elegans} to remain intact and unrestrained. Previously the Samuel Lab was the first to manually track a worm and observe its calcium transients as it moved freely \citep{clark_temporal_2007}. In this thesis I develop an automated system to track the worm and either apply optogenetic stimuli or monitor calcium transients.



\subsection{Real-Time Computer Vision}

Conducting optical physiology on individual neurons in a moving worm requires significant ancillary hardware and software to identify the worm's outline, track it and keep it centered, identify targeted neurons within the worm and precisely illuminate and image those neurons in real-time --all while simultaneously recording the worm's macroscopic behavior. 
A number of technological advancements  make this now possible. In addition to the development of optogenetics and fluorescent indicators, the ever decreasing cost of computer power, the  availability of high power CW lasers in a variety of wavelengths,  the advent of microelectromechanical systems (MEMS), and the development of powerful open source-computer vision libraries have  conspired to make such a purely-optical system feasible for the first time. 

It has only been in the past decade that the field of real-time computer vision algorithms has advanced to the point that libraries are now readily accessible to  perform real-time video analysis using standard computer hardware. For example, this work utilizes hardware-optimized routines in the open-source OpenCV library \citep{bradski_opencv_2000,bradski_learning_2008}. That library was only recently developed, in part, to address the DARPA Grand Challenge autonomous vehicle competition in 2004 and 2005  \citep{stavens_learning_2011,buehler_stanley:_2007}. Fortuitously, many closed-loop real-time image processing
techniques for such applications can be applied to solve the optogenetic instrumentation problems of interest here. Consequently, this work builds upon prior computer vision developments from the DARPA Grand Challenge and elsewhere.



\subsection{Applications to Behavioral Neuroscience}


This work brings together advances in optogenetics and real-time computer vision to systematically perturb and monitor neural activity across an entire organism while it is behaving.  At the time this thesis work began, it was the first successful effort to bring these disparate strands together in the study of neural activity in \textit{C. elegans}.

I have used the tools developed here to study neural activity driving \emph{C. elegans} locomotion. The worm crawls on its side and propels itself forward by propagating bending waves from its head to tail.  The worm has 95 muscles and 302 neurons at its disposal. Of those 302 neurons, 113 are classified as motor neurons, that  directly enervate muscles. For successful locomotion, all of these muscles and neurons must work together in a coordinated and coherent fashion, interacting with sensory neurons and  networks of neighboring neurons to process and respond to environmental conditions. For an excellent review of the \textit{C. elegans}  motor circuit see \citep{von_stetina_motor_2006}. While it is fairly well understood which neurons  in \textit{C. elegans} are required for forward and backward locomotion, respectively, the dynamics of neural activity are largely unknown. In fact, many of the community's assumptions derive from leech and lamprey experiments \citep{friesen_sensory_2001, karbowski_systems_2008} and it is unclear to what extend those findings apply to \textit{C. elegans}. Open questions include: Where are the oscillations that drive undulatory motion generated? Are the undulatory waves propagated through neurons or muscles? To what extent is  feedback from the animal's environment required for locomotion? 

%ANDY!! THIS IS YOUR CHANCE TO COPY AND PASTE FROM THE ABSTRACT.
%


Chapters \ref{chapter:colbert} and \ref{chapter:proprioceptive} provide answers to some of these questions, and place strong experimental constrains on future models for \textit{C. elegans} locomotion.  Chapter \ref{chapter:omegaTurn} takes these questions to an even higher level, and asks how the worm's nervous system transitions between forward and backward locomotion. 



\subsection{Additional applications of computer vision for molecular biophysics}
The computer vision techniques that I have developed here can also be applied to a wide variety of applications beyond behavioral neuroscience. In Chapters \ref{chapter:DNAbarcode} and \ref{chapter:DNAtheory}, I develop related software to automatically locate and identify fluorescing DNA origami nanorod barcodes . Unlike the chapters devoted to \textit{C. elegans}, which focus primarily on the work in relation to \textit{C. elegans} neuroscience, the chapters on DNA barcodes include rigorous descriptions of the software algorithms used and  their mathematical underpinnings. All of the software described in this thesis is freely available under an open-source license.   In general, the approach taken to analyze images of DNA barcodes is representative of the approach to the computer vision problems in the remaining chapters. In particular, the number of steps in the algorithms in Chapter \ref{chapter:DNAtheory} offers a window into the complexity and challenge of quantitatively analyzing biological systems. 


%TRANSITION



\subsection{Onwards}
Systems neuroscience is approaching  a critical juncture. Arguably for the first time, the tools are becoming available to enable the  complete characterization of how the neural activity of an entire organism drives  behavior. Not only  do the tools presented here allow for direct observation of neural activity,  they also provide the means to perturb neural activity--both while simultaneously observing behavior. We now turn to the work itself.


